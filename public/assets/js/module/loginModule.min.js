define(["jquery","module/CSRFCheckManager"],(function($,CSRFM){var m;return function(){var CSRFCheckManager=new CSRFM;function init(){CSRFCheckManager.init(),$("#btn-login").click((function(){return login()})),$("#btn-login-ajax").click((function(){return loginAjax()}))}function login(){return removeFormError(),0==$("#btk_usr").val().length||0==$("#btk_pwd").val().length?(setFormError("Inserisci username e password"),!1):"undefined"!=typeof captchaResult&&0==captchaResult?(setFormError("You must complete reCaptcha validation"),!1):(CSRFCheckManager.addToForm($("#loginform")),void $("#loginform").submit())}function loginAjax(){if(removeFormError(),0==$("#btk_usr-ajax").val().length||0==$("#btk_pwd-ajax").val().length)return setFormErrorAjax("Inserisci username e password"),!1;CSRFCheckManager.addToForm($("#loginform-ajax"));var data={};data.username=$("#btk_usr-ajax").val(),data.password=$("#btk_pwd-ajax").val(),data.rememberme=$("#login-remember-ajax").is(":checked");var dataToSend=JSON.stringify(data),apiUrl=rootUrl+"api/login";$.ajax({type:"POST",dataType:"json",contentType:"application/json",url:apiUrl,data:dataToSend,beforeSend:function(){$("#btn-login-ajax").prop("disabled",!0)},complete:function(){$("#btn-login-ajax").prop("disabled",!1)},success:function(response){0!=response?1==response.error?$("#form-validation-error-ajax").text(response.data):location.reload():$("#form-validation-error-ajax").text("generic error")},error:function(e){console.log(e)}})}function setFormError(message){$("#form-validation-error").text(message).show()}function setFormErrorAjax(message){$("#form-validation-error-ajax").text(message).show()}function removeFormError(){$("#form-validation-error").hide(),$("#form-validation-error-ajax").hide()}return{init:init}}}));
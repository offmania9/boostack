define(["jquery","module/CSRFCheckManager"],(function($,CSRFM){var m;return function(){var CSRFCheckManager=new CSRFM;function init(){CSRFCheckManager.init(),$("#registration-form").submit((function(){return registration()})),$("#btn-registration-ajax").click((function(){return registrationAjax()}))}function registration(){return removeFormError(),0==$("#reg-email").val().length||0==$("#reg-pwd1").val().length||0==$("#reg-pwd2").val().length?(setFormError("You must insert username and password"),!1):$("#reg-pwd1").val()!=$("#reg-pwd2").val()?(setFormError("Passwords must be equals"),!1):(CSRFCheckManager.addToForm($("#registration-form")),!0)}function registrationAjax(){if(removeFormError(),0==$("#reg-first_name-ajax").val().length)return setFormErrorAjax("You must insert First name"),!1;if(0==$("#reg-last_name-ajax").val().length)return setFormErrorAjax("You must insert Last name"),!1;if(0==$("#reg-email-ajax").val().length||!isEmail($("#reg-email-ajax").val()))return setFormErrorAjax("You must insert a valid e-mail address"),!1;if(0==$("#reg-pwd-ajax").val().length)return setFormErrorAjax("You must insert password"),!1;if($("#reg-pwd-ajax").val().length<7)return setFormErrorAjax("Password too short. Use 8 characters or longer."),!1;if(!checkPasswordStrength($("#reg-pwd-ajax").val()))return setFormErrorAjax("Password must contain both lower and uppercase characters. Password must contain at least one number and one special character"),!1;if(!$("#register-agree").is(":checked"))return setFormErrorAjax("you must Agree to terms and conditions"),!1;function isEmail(email){var regex;return/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(email)}function checkPasswordStrength(password){var number=/([0-9])/,alphabets=/([a-z].*[A-Z])|([A-Z].*[a-z])/,special_characters=/([~,!,@,#,$,%,^,&,*,-,-,_,+,=,?,>,<])/;return password.match(number)&&password.match(alphabets)&&password.match(special_characters)}function checkStrength(password){return!!password.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)&&(!(!password.match(/([a-zA-Z])/)&&password.match(/([0-9])/))&&!password.match(/([!,%,&,@,#,$,^,*,?,_,~])/))}CSRFCheckManager.addToForm($("#registration-form-ajax"));var data={};data.password=$("#reg-pwd-ajax").val(),data.password_confirm=$("#reg-pwd-ajax").val(),data.email=$("#reg-email-ajax").val(),data.first_name=$("#reg-first_name-ajax").val(),data.last_name=$("#reg-last_name-ajax").val(),data.agree=$("#register-agree").is(":checked"),data.BCSRFT=$("#BCSRFT").val();var dataToSend=JSON.stringify(data),apiUrl=rootUrl+"api/registrationFirstStep";$.ajax({type:"POST",dataType:"json",contentType:"application/json",url:apiUrl,data:dataToSend,beforeSend:function(){$("#btn-registration-ajax").prop("disabled",!0)},complete:function(){$("#btn-registration-ajax").prop("disabled",!1)},success:function(response){0!=response?1==response.error?$("#registration-alert").text(response.data).show():location.reload():$("#registration-alert").text("generic error").show()},error:function(e){console.log(e),void 0!==e.responseJSON.message?$("#registration-alert").text(e.responseJSON.message).show():$("#registration-alert").text("Attention! generic error").show()}})}function setFormError(message){$("#form-validation-error").text(message).show()}function setFormErrorAjax(message){$("#registration-alert").text(message).show()}function removeFormError(){$("#form-validation-error").hide(),$("#registration-alert").hide()}return{init:init}}}));
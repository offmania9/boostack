function checkDB(callback){var data={host:$("#db-host").val(),driver_pdo:$("#driver-pdo").val(),dbname:$("#db-name").val(),port:$("#db-port").val(),username:$("#db-username").val(),password:$("#db-password").val()};$.ajax({type:"POST",url:"dbTest.php",data:data,dataType:"json",cache:!1,complete:function(response,status){"success"==response.responseText?($("#dbStatus").text(" Success"),$("#dbStatus").attr("class","text-success"),$("#dbStatusIcon").attr("class","glyphicon glyphicon-ok"),"function"==typeof callback&&callback(!0)):($("#dbStatus").text(" Failure: "+response.responseText),$("#dbStatus").attr("class","text-danger"),$("#dbStatusIcon").attr("class","glyphicon glyphicon-remove"),"function"==typeof callback&&callback(!1))}})}function scrollToDiv(divID){$("html, body").scrollTop($(document).height()-$("#"+divID).offset().top)}$(document).ready((function(){function updateURL(){var protocol=$("#protocol").val(),dn=$("#dn").val(),port=$("#port").val(),rootpath=$("#rootpath").val();if($.isNumeric(port)&&Math.floor(port)==port){var url=protocol+"://"+dn+":"+port+rootpath;$("#url").val(url)}else alert("Il valore del campo Port deve essere un intero."),$("#url").val(""),$("#port").val("")}$("#port, #protocol, #dn, #rootpath").on("change input",(function(){updateURL()})),$(".setup tr.bg-danger").length>0&&$(".setup .setupInstaller, .setup #initsetup-btn").hide();var loginStrategyItems=$("input[name^='db-loginLock-']").parents(".form-group");loginStrategyItems.hide(),$("input[name$='db-active']").click((function(){var dbItems=$("[rel='db-active']");"true"==$(this).val()?(dbItems.show(),$("input[id$='db-session-true']").trigger("click"),$("input[id$='db-cookie-true']").trigger("click"),$("input[id$='db-log-true']").trigger("click"),$("input[id$='lockStrategy-on-false']").trigger("click")):(dbItems.hide(),$("input[id$='db-session-false']").trigger("click"),$("input[id$='db-cookie-false']").trigger("click"),$("input[id$='db-log-false']").trigger("click"),$("input[id$='lockStrategy-on-false']").trigger("click"))})),$("input[name$='db-session-active']").click((function(){"false"==$(this).val()&&$("input[id$='db-cookie-false']").trigger("click")})),$("input[name$='db-cookie-active']").click((function(){var dbItems=$("input[name^='db-cookie']").parents(".form-group:not('.noHideCookie')");"true"==$(this).val()?($("input[id$='db-session-true']").trigger("click"),dbItems.show()):dbItems.hide()})),$("#lockStrategy-on-true").click((function(){loginStrategyItems.show(),$("#recaptcha").trigger("click")})),$("#lockStrategy-on-false").click((function(){loginStrategyItems.hide()})),$("#recaptcha").click((function(){$("#recaptcha_public").closest(".form-group").show(),$("#recaptcha_private").closest(".form-group").show(),$("#timer_seconds").closest(".form-group").hide()})),$("#timer").click((function(){$("#recaptcha_public").closest(".form-group").hide(),$("#recaptcha_private").closest(".form-group").hide(),$("#timer_seconds").closest(".form-group").show()}))})),$("form").submit((function(e){e.preventDefault(),$("#db-true").is(":checked")?checkDB((function(db_ok){db_ok?$(e.target).unbind("submit").submit():scrollToDiv("btnCheckDB")})):$(this).unbind("submit").submit()}));